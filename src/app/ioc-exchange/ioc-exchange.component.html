<div class="ioc-container">
  <div class="card">
    <form (ngSubmit)="onShareIOC()" class="form-section">
      <h3 style="font-family: 'Anton', sans-serif; font-size: 38px; color: white;">SUBMIT AN IOC</h3>

      <div class="form-row">
        <div class="form-group">
          <label
            >IOC Type
            <span style="font-weight: normal; color: white; "
              >(e.g., Malware, Phishing)</span
            ></label
          >
          <select name="type">
            <option *ngFor="let type of iocTypes" [value]="type">
              {{ type }}
            </option>
          </select>
        </div>

        <div class="form-group">
          <label>IOC ID *</label>
          <input type="text" [(ngModel)]="newIOC.id" name="id" required />
        </div>

        <div class="form-group">
          <label>Submitted By *</label>
          <input
            type="text"
            [(ngModel)]="newIOC.submittedBy"
            name="submittedBy"
            required
          />
        </div>

        <div class="form-group">
          <label>Threat Name *</label>
          <input
            type="text"
            [(ngModel)]="newIOC.threatName"
            name="threatName"
            required
          />
        </div>

        <div class="form-group">
          <label>IPFS Hash *</label>
          <input
            type="text"
            [(ngModel)]="newIOC.ipfsHash"
            name="ipfsHash"
            required
          />
        </div>
      </div>

      <button type="submit" class="btn-primary">Submit IOC</button>
    </form>

    <hr />

    <form (ngSubmit)="onQueryIOC()" class="form-section">
      <h3 style="font-family: 'Anton', sans-serif; font-size: 38px; color: white;">QUERY IOCs</h3>

      <div class="form-row">
        <div class="form-group">
          <label>Search Indicator</label>
          <input
            type="text"
            [(ngModel)]="queryTerm"
            name="queryTerm"
            placeholder="IP, Domain, Hash..."
          />
        </div>
        <div class="form-group">
          <label>Threat Actor</label>
          <input
            type="text"
            [(ngModel)]="filters.threatActor"
            name="threatActor"
          />
        </div>
        <div class="form-group">
          <label>Status</label>
          <select [(ngModel)]="filters.status" name="status">
            <option value="">Any</option>
            <option value="validated">Validated</option>
            <option value="pending">Pending Validation</option>
          </select>
        </div>
      </div>

      <button type="submit" class="btn-secondary">Search</button>
    </form>

    <div *ngIf="queryResults.length > 0" class="results">
      <h4>Search Results</h4>
      <table>
        <thead>
          <tr>
            <th>Type</th>
            <th>Title</th>
            <th>Value</th>
            <th>Status</th>
            <th>Last Seen</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let result of queryResults">
            <td>{{ result.type }}</td>
            <td>{{ result.title }}</td>
            <td>{{ result.value }}</td>
            <td>{{ result.status }}</td>
            <td>{{ result.lastSeen }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
