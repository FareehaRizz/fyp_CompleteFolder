<div class="ioc-container">
  <div class="card">
    <form (ngSubmit)="onShareIOC()" class="form-section">
      <h3 style="font-family: 'Anton', sans-serif; font-size: 38px; color: white;">SUBMIT AN IOC</h3>

      <div class="form-row">
        <div class="form-group">
          <label
            >IOC Type
            <span style="font-weight: normal; color: white; "
              >(e.g., Malware, Phishing)</span
            ></label
          >
          <select name="type">
            <option *ngFor="let type of iocTypes" [value]="type">
              {{ type }}
            </option>
          </select>
        </div>

        <div class="form-group">
          <label>IOC ID *</label>
          <input type="text" [(ngModel)]="newIOC.id" name="id" required />
        </div>

        <div class="form-group">
          <label>Submitted By *</label>
          <input
            type="text"
            [(ngModel)]="newIOC.reporter"
            name="reporter"
            required
          />
        </div>

        <div class="form-group">
          <label>Threat Detail</label>
          <input
            type="text"
            [(ngModel)]="newIOC.details"
            name="details"
            required
          />
        </div>

        <div class="form-group">
          <label>IPFS Hash *</label>
          <input
            type="text"
            [(ngModel)]="newIOC.ipfsHash"
            name="ipfsHash"
            required
          />
        </div>
      </div>

      <button type="submit" class="btn-primary">Submit IOC</button>
    </form>

    <hr />

    <div class="container mt-4">
      <h3>Query IOC by ID</h3>

      <form (ngSubmit)="onQueryById()" class="mb-3">
        <div class="form-group">
          <label for="iocId">IOC ID</label>
          <input
            type="text"
            id="iocId"
            class="form-control"
            name="iocId"
            [(ngModel)]="iocId"
            required
          />
        </div>
        <button class="btn btn-primary mt-2" type="submit">Fetch IOC</button>
      </form>

      <div *ngIf="error" class="alert alert-danger">
        {{ error }}
      </div>

      <div *ngIf="iocResult" class="card p-3" 
     style="background: #23272b; border: 2px solid #fff; box-shadow: 0 2px 12px #0008; color: #fff;">
  <h5 style="font-family: 'Anton', sans-serif; font-size: 26px; font-weight: 900; color: #fff; text-shadow: 1px 1px 4px #000;">
    IOC Details
  </h5>
  <p><strong>ID:</strong> {{ iocResult.id }}</p>
  <p><strong>Submitted By:</strong> {{ iocResult.reporter }}</p>
  <p><strong>Threat Detail:</strong> {{ iocResult.details }}</p>
  <p><strong>IPFS Hash:</strong> {{ iocResult.ipfsHash }}</p>
</div>

    <hr />
    <form (ngSubmit)="onValidateIOC()" class="form-section">
      <h3>Validate an IOC</h3>

      <div class="form-row">
        <div class="form-group">
          <label>IOC ID</label>
          <input
            type="text"
            [(ngModel)]="validateId"
            name="validateId"
            required
          />
        </div>

        <div class="form-group">
          <label>Validator Name</label>
          <input
            type="text"
            [(ngModel)]="validatorName"
            name="validatorName"
            required
          />
        </div>
      </div>

      <button type="submit" class="btn-secondary">Validate IOC</button>

      <div *ngIf="validateMessage" class="success" style="margin-top: 10px">
        {{ validateMessage }}
      </div>
      <div
        *ngIf="validateError"
        class="error"
        style="color: white; margin-top: 10px"
      >
        {{ validateError }}
      </div>
    </form>
  </div>
</div>
